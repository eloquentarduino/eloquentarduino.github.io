<!DOCTYPE html>
<html lang="en-US"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> <script>function fvmuag(){if(navigator.userAgent.match(/x11.*fox\/54|oid\s4.*xus.*ome\/62|oobot|ighth|tmetr|eadles|ingdo/i))return!1;if(navigator.userAgent.match(/x11.*ome\/75\.0\.3770\.100/i)){var e=screen.width,t=screen.height;if("number"==typeof e&&"number"==typeof t&&862==t&&1367==e)return!1}return!0}</script><title>Passive-aggressive classifier for embedded devices</title><style type="text/css">.heateorSssInstagramBackground{background:radial-gradient(circle at 30% 107%,#fdf497 0,#fdf497 5%,#fd5949 45%,#d6249f 60%,#285aeb 90%)} .heateor_sss_horizontal_sharing .heateorSssSharing,.heateor_sss_standard_follow_icons_container .heateorSssSharing{ color: #fff; border-width: 0px; border-style: solid; border-color: transparent; } .heateor_sss_horizontal_sharing .heateorSssTCBackground{ color:#666; } .heateor_sss_horizontal_sharing .heateorSssSharing:hover,.heateor_sss_standard_follow_icons_container .heateorSssSharing:hover{ border-color: transparent; } .heateor_sss_vertical_sharing .heateorSssSharing,.heateor_sss_floating_follow_icons_container .heateorSssSharing{ color: #fff; border-width: 0px; border-style: solid; border-color: transparent; } .heateor_sss_vertical_sharing .heateorSssTCBackground{ color:#666; } .heateor_sss_vertical_sharing .heateorSssSharing:hover,.heateor_sss_floating_follow_icons_container .heateorSssSharing:hover{ border-color: transparent; } @media screen and (max-width:783px) {.heateor_sss_vertical_sharing{display:none!important}}@media screen and (max-width:783px) {.heateor_sss_floating_follow_icons_container{display:none!important}}div.heateor_sss_mobile_footer{display:none;}@media screen and (max-width:783px){i.heateorSssTCBackground{background-color:white!important}div.heateor_sss_bottom_sharing{width:100%!important;left:0!important;}div.heateor_sss_bottom_sharing li{width:33.333333333333% !important;}div.heateor_sss_bottom_sharing .heateorSssSharing{width: 100% !important;}div.heateor_sss_bottom_sharing div.heateorSssTotalShareCount{font-size:1em!important;line-height:28px!important}div.heateor_sss_bottom_sharing div.heateorSssTotalShareText{font-size:.7em!important;line-height:0px!important}div.heateor_sss_mobile_footer{display:block;height:40px;}.heateor_sss_bottom_sharing{padding:0!important;display:block!important;width: auto!important;bottom:-2px!important;top: auto!important;}.heateor_sss_bottom_sharing .heateor_sss_square_count{line-height: inherit;}.heateor_sss_bottom_sharing .heateorSssSharingArrow{display:none;}.heateor_sss_bottom_sharing .heateorSssTCBackground{margin-right: 1.1em !important}}div.heateor_sss_sharing_title{text-align:center}ul.heateor_sss_sharing_ul{width:100%;text-align:center;}div.heateor_sss_horizontal_sharing ul.heateor_sss_sharing_ul li{float:none!important;display:inline-block;}</style><meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Passive-aggressive classifier for embedded devices"><meta property="og:description" content="When working with memory constrained devices you may not able to keep all the training data in memory: passive-aggressive classifiers may help solve your memory problems. Batch learning A couple weeks ago I started exploring the possibility to train a machine learning classifier directly on a microcontroller. Since I like SVM, I ported the simplified …"><meta property="og:url" content="https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/"><meta property="og:site_name" content="Eloquent Arduino Blog"><meta property="article:tag" content="microml"><meta property="article:tag" content="online-learning"><meta property="article:section" content="Arduino Machine learning"><meta property="article:published_time" content="2020-04-05T17:04:10+00:00"><meta property="article:modified_time" content="2020-04-10T18:39:10+00:00"><meta property="og:updated_time" content="2020-04-10T18:39:10+00:00"><meta property="og:image" content="https://eloquentarduino.github.io/wp-content/uploads/2020/04/passive-aggressive-classifier.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:description" content="When working with memory constrained devices you may not able to keep all the training data in memory: passive-aggressive classifiers may help solve your memory problems. Batch learning A couple weeks ago I started exploring the possibility to train a machine learning classifier directly on a microcontroller. Since I like SVM, I ported the simplified […]"><meta name="twitter:title" content="Passive-aggressive classifier for embedded devices"><meta name="twitter:image" content="https://eloquentarduino.github.io/wp-content/uploads/2020/04/passive-aggressive-classifier.png"> <script type="application/ld+json" class="yoast-schema-graph yoast-schema-graph--main">{"@context":"https://schema.org","@graph":[{"@type":["Person","Organization"],"@id":"https://eloquentarduino.github.io/#/schema/person/c35265597251f0133ecca5b413d12901","name":"simone","image":{"@type":"ImageObject","@id":"https://eloquentarduino.github.io/#personlogo","inLanguage":"en-US","url":"https://eloquentarduino.github.io/wp-content/uploads/2019/12/avatar.jpg","width":330,"height":330,"caption":"simone"},"logo":{"@id":"https://eloquentarduino.github.io/#personlogo"},"sameAs":[]},{"@type":"WebSite","@id":"https://eloquentarduino.github.io/#website","url":"https://eloquentarduino.github.io/","name":"Eloquent Arduino Blog","inLanguage":"en-US","description":"Machine learning on Arduino, programming & electronics","publisher":{"@id":"https://eloquentarduino.github.io/#/schema/person/c35265597251f0133ecca5b413d12901"},"potentialAction":[{"@type":"SearchAction","target":"https://eloquentarduino.github.io/?s={search_term_string}","query-input":"required name=search_term_string"}]},{"@type":"ImageObject","@id":"https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/#primaryimage","inLanguage":"en-US","url":"https://eloquentarduino.github.io/wp-content/uploads/2020/04/passive-aggressive-classifier.png","width":768,"height":487,"caption":"Passive aggressive classifier"},{"@type":"WebPage","@id":"https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/#webpage","url":"https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/","name":"Passive-aggressive classifier for embedded devices","isPartOf":{"@id":"https://eloquentarduino.github.io/#website"},"inLanguage":"en-US","primaryImageOfPage":{"@id":"https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/#primaryimage"},"datePublished":"2020-04-05T17:04:10+00:00","dateModified":"2020-04-10T18:39:10+00:00","potentialAction":[{"@type":"ReadAction","target":["https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/"]}]},{"@type":"Article","@id":"https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/#article","isPartOf":{"@id":"https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/#webpage"},"author":{"@id":"https://eloquentarduino.github.io/#/schema/person/c35265597251f0133ecca5b413d12901"},"headline":"Passive-aggressive classifier for embedded devices","datePublished":"2020-04-05T17:04:10+00:00","dateModified":"2020-04-10T18:39:10+00:00","commentCount":0,"mainEntityOfPage":{"@id":"https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/#webpage"},"publisher":{"@id":"https://eloquentarduino.github.io/#/schema/person/c35265597251f0133ecca5b413d12901"},"image":{"@id":"https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/#primaryimage"},"keywords":"microml,online-learning","articleSection":"Arduino Machine learning","inLanguage":"en-US"}]}</script> <link rel="stylesheet" id="wilson_fonts-css" href="https://fonts.googleapis.com/css?family=Lato%3A400%2C700%2C400italic%2C700italic&ver=1" type="text/css" media="all"><link rel="stylesheet" id="fvm-header-0-css" href="https://eloquentarduino.github.io/wp-content/uploads/cache/fvm/1586711349/out/header-8a598149411b696ce2798aecc355701ddb9c9863.min.css" type="text/css" media="all"><link rel="stylesheet" id="font-awesome-official-css" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css" type="text/css" media="all" integrity="sha384-REHJTs1r2ErKBuJB0fCK99gCYsVjwxHrSU0N7I1zl9vZbggVJXRMsv/sLlOAGb4M" crossorigin="anonymous"><link rel="stylesheet" id="fvm-header-2-css" href="https://eloquentarduino.github.io/wp-content/uploads/cache/fvm/1586711349/out/header-6838d7ea6e0d0484a95a8dba38f599cf76d23816.min.css" type="text/css" media="all"><link rel="stylesheet" id="font-awesome-official-v4shim-css" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css" type="text/css" media="all" integrity="sha384-AL44/7DEVqkvY9j8IjGLGZgFmHAjuHa+2RIWKxDliMNIfSs9g14/BRpYwHrWQgz6" crossorigin="anonymous"><style id="font-awesome-official-v4shim-inline-css" type="text/css">@font-face { font-family: "FontAwesome"; src: url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-brands-400.eot"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-brands-400.eot?#iefix") format("embedded-opentype"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-brands-400.woff2") format("woff2"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-brands-400.woff") format("woff"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-brands-400.ttf") format("truetype"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-brands-400.svg#fontawesome") format("svg"); } @font-face { font-family: "FontAwesome"; src: url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-solid-900.eot"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-solid-900.eot?#iefix") format("embedded-opentype"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-solid-900.woff2") format("woff2"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-solid-900.woff") format("woff"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-solid-900.ttf") format("truetype"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-solid-900.svg#fontawesome") format("svg"); } @font-face { font-family: "FontAwesome"; src: url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-regular-400.eot"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-regular-400.eot?#iefix") format("embedded-opentype"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-regular-400.woff2") format("woff2"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-regular-400.woff") format("woff"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-regular-400.ttf") format("truetype"), url("https://use.fontawesome.com/releases/v5.12.0/webfonts/fa-regular-400.svg#fontawesome") format("svg"); unicode-range: U+F004-F005,U+F007,U+F017,U+F022,U+F024,U+F02E,U+F03E,U+F044,U+F057-F059,U+F06E,U+F070,U+F075,U+F07B-F07C,U+F080,U+F086,U+F089,U+F094,U+F09D,U+F0A0,U+F0A4-F0A7,U+F0C5,U+F0C7-F0C8,U+F0E0,U+F0EB,U+F0F3,U+F0F8,U+F0FE,U+F111,U+F118-F11A,U+F11C,U+F133,U+F144,U+F146,U+F14A,U+F14D-F14E,U+F150-F152,U+F15B-F15C,U+F164-F165,U+F185-F186,U+F191-F192,U+F1AD,U+F1C1-F1C9,U+F1CD,U+F1D8,U+F1E3,U+F1EA,U+F1F6,U+F1F9,U+F20A,U+F247-F249,U+F24D,U+F254-F25B,U+F25D,U+F267,U+F271-F274,U+F279,U+F28B,U+F28D,U+F2B5-F2B6,U+F2B9,U+F2BB,U+F2BD,U+F2C1-F2C2,U+F2D0,U+F2D2,U+F2DC,U+F2ED,U+F328,U+F358-F35B,U+F3A5,U+F3D1,U+F410,U+F4AD; }</style> <script type="text/javascript" src="https://eloquentarduino.github.io/wp-content/uploads/cache/fvm/1586711349/out/header-f0058641a050d28b94dd899c6780665c0c05dbf9.min.js"></script><style type="text/css">0</style><meta name="google-site-verification" content="xgigjPrbbYDemskTaGLT9WGhmw8wgdeFtpDxVak0awI"><link href="/assets/app.css" rel="stylesheet"> <style type="text/css"></style></head><body class="post-template-default single single-post postid-1050 single-format-standard"><div class="wrapper"><div class="sidebar"><div class="blog-header"> <a class="blog-logo" href="https://eloquentarduino.github.io" title="Eloquent Arduino Blog — Machine learning on Arduino, programming & electronics" rel="home"> <img src="https://eloquentarduino.github.io/wp-content/uploads/2019/12/logo-completo.png" alt="Eloquent Arduino Blog"> </a></div><div class="nav-toggle toggle"><p> <span class="show">Show menu</span> <span class="hide">Hide menu</span></p><div class="bars"><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="clear"></div></div></div><div class="blog-menu"><ul class="navigation"><li id="menu-item-461" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-461"><a href="https://eloquentarduino.github.io/category/programming/arduino-machine-learning/">Arduino Machine learning</a></li><li id="menu-item-462" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-462"><a href="https://eloquentarduino.github.io/category/programming/eloquent-library/">Eloquent library</a></li></ul><div class="clear"></div></div><div class="mobile-menu"><ul class="navigation"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-461"><a href="https://eloquentarduino.github.io/category/programming/arduino-machine-learning/">Arduino Machine learning</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-462"><a href="https://eloquentarduino.github.io/category/programming/eloquent-library/">Eloquent library</a></li></ul></div><div class="widgets" role="complementary"><div class="widget_text widget widget_custom_html"><div class="widget_text widget-content"><div class="textwidget custom-html-widget"><div style="text-align: center"> <img src="/wp-content/uploads/2020/04/profilo.png" alt="Profile pic" style="width: 125px"> <a href="/about-me" style="display: block; font-size: 18px">About me</a></div></div></div><div class="clear"></div></div><div class="widget widget_search"><div class="widget-content"><form method="get" class="searchform" action="https://eloquentarduino.github.io" id="searchform"><div role="search" class="searchbox__wrapper"> <input id="search-input" type="search" name="search" placeholder="Search the blog" autocomplete="off" required="required" class="searchbox__input"> <button type="submit" title="Submit your search query." class="searchbox__submit"> <svg role="img" aria-label="Search"> <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#sbx-icon-search-13"></use> </svg> </button> <button type="reset" title="Clear the search query." class="searchbox__reset hide"> <svg role="img" aria-label="Reset"> <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#sbx-icon-clear-3"></use> </svg> </button></div></form></div><div class="clear"></div></div><div class="widget widget_recent_entries"><div class="widget-content"><h3 class="widget-title">Recent Posts</h3><ul><li> <a href="https://eloquentarduino.github.io/2020/04/stochastic-gradient-descent-on-your-microcontroller/">Stochastic Gradient Descent on your microcontroller</a></li><li> <a href="https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/" aria-current="page">Passive-aggressive classifier for embedded devices</a></li><li> <a href="https://eloquentarduino.github.io/2020/03/how-to-train-a-color-classification-machine-learning-classifier-directly-on-your-arduino-board/">How to train a color classification Machine learning classifier directly on your Arduino board</a></li><li> <a href="https://eloquentarduino.github.io/2020/03/how-to-train-a-iris-classification-machine-learning-classifier-directly-on-your-arduino-board/">How to train a IRIS classification Machine learning classifier directly on your Arduino board</a></li><li> <a href="https://eloquentarduino.github.io/2020/03/so-you-want-to-train-an-ml-classifier-directly-on-an-arduino-board/">So you want to train an ML classifier directly on an Arduino board?</a></li></ul></div><div class="clear"></div></div><div class="widget widget_sub_categories"><div class="widget-content"><h3 class="widget-title">Programming</h3><ul><li class="cat-item cat-item-8"><a href="https://eloquentarduino.github.io/category/programming/arduino-machine-learning/">Arduino Machine learning</a></li><li class="cat-item cat-item-12"><a href="https://eloquentarduino.github.io/category/programming/computer-vision/">Computer vision</a></li><li class="cat-item cat-item-7"><a href="https://eloquentarduino.github.io/category/programming/eloquent-library/">Eloquent library</a></li></ul></div><div class="clear"></div></div><div class="widget widget_tag_cloud"><div class="widget-content"><h3 class="widget-title">TAGS</h3><div class="tagcloud"><a href="https://eloquentarduino.github.io/tag/camera/" class="tag-cloud-link tag-link-11 tag-link-position-1" style="font-size: 12.516129032258pt;" aria-label="camera (3 items)">camera</a> <a href="https://eloquentarduino.github.io/tag/eloquent/" class="tag-cloud-link tag-link-4 tag-link-position-2" style="font-size: 12.516129032258pt;" aria-label="eloquent (3 items)">eloquent</a> <a href="https://eloquentarduino.github.io/tag/esp32/" class="tag-cloud-link tag-link-10 tag-link-position-3" style="font-size: 12.516129032258pt;" aria-label="esp32 (3 items)">esp32</a> <a href="https://eloquentarduino.github.io/tag/microml/" class="tag-cloud-link tag-link-5 tag-link-position-4" style="font-size: 22pt;" aria-label="microml (16 items)">microml</a> <a href="https://eloquentarduino.github.io/tag/online-learning/" class="tag-cloud-link tag-link-15 tag-link-position-5" style="font-size: 10.709677419355pt;" aria-label="online-learning (2 items)">online-learning</a> <a href="https://eloquentarduino.github.io/tag/rvm/" class="tag-cloud-link tag-link-13 tag-link-position-6" style="font-size: 8pt;" aria-label="rvm (1 item)">rvm</a> <a href="https://eloquentarduino.github.io/tag/svm/" class="tag-cloud-link tag-link-14 tag-link-position-7" style="font-size: 8pt;" aria-label="svm (1 item)">svm</a></div></div><div class="clear"></div></div></div></div><div class="content"><div class="posts"><div id="post-1050" class="post-1050 post type-post status-publish format-standard hentry category-arduino-machine-learning tag-microml tag-online-learning"><div class="post-inner"><div class="post-header"><h1 class="post-title"><a href="https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/" rel="bookmark" title="Passive-aggressive classifier for embedded devices">Passive-aggressive classifier for embedded devices</a></h1><div class="post-meta"> <span class="post-date"><a href="https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/" title="Passive-aggressive classifier for embedded devices">5 April 2020</a></span> <span class="date-sep"> / </span> <span class="post-author"><a href="https://eloquentarduino.github.io/author/simone/" title="Posts by simone" rel="author">simone</a></span></div></div><div class="post-content"><div class="has-content-area" data-url="https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/" data-title="Passive-aggressive classifier for embedded devices"><p>When working with memory constrained devices you may not able to keep all the training data in memory: passive-aggressive classifiers may help solve your memory problems.</p><p><span id="more-1050"></span></p><h2>Batch learning</h2><p>A couple weeks ago I started exploring the possibility to train a machine learning classifier directly on a microcontroller. Since I like SVM, <a href="/2020/03/so-you-want-to-train-an-ml-classifier-directly-on-an-arduino-board">I ported the simplified SVM SMO (Sequential Minimal Optimization) algorithm</a> to plain C, ready to be deployed to embedded devices.</p><p>Now, that kind of algorithm works in the so-called "batch-mode": it needs all the training data to be available in memory to learn.</p><p>This may be a limiting factor on resource-constrained devices, since it poses an upper bound to the number of samples you can train on. And when working with high-dimensional datasets, the number of samples could be not enough to achieve good accuracy.</p><h2>Enter incremental learning</h2><p>To solve this limitation, you need a totally different kind of learning algorithms: you need incremental (a.k.a online a.k.a out of core) learning.</p><p>Incremental learning works by inspecting one training sample at a time, instead of all at once.</p><p>The clear advantage is that you have a tiny memory footprint. And this is a <strong>huge</strong> advantage.</p><p>The clear disadvantage is that you don't have the "big picture" of your data, so:</p><ul><li>the end result will probably be affected by the order of presentation of the samples</li><li>you may not be able to achieve top accuracy</li></ul><h2>Passive-aggressive classifier</h2><p>Passive-aggressive classification is one of the available incremental learning algorithms and it is very simple to implement, since it has a closed-form update rule.</p><p>Please refer to this <a href="https://www.bonaccorso.eu/2017/10/06/ml-algorithms-addendum-passive-aggressive-algorithms/">short explanation on Passive-aggressive classifiers</a> for a nice description with images.</p><p>The core concept is that the classifier adjusts it weight vector for each mis-classified training sample it receives, trying to get it correct.</p><p><img src="https://eloquentarduino.github.io/wp-content/uploads/2020/04/passive-aggressive-classifier.png" alt="Passive aggressive classifier"></p><h2>Benchmarks</h2><p>I run a couple benchmark on my Esp32 to assess both accuracy and training time.</p><p>First of all: <strong>it is fast!</strong>. When I say it is fast I mean it takes ~1ms to train on 400 samples x 30 features each.</p><p>Talking about accuracy instead... Uhm...</p><p>Accuracy vary. <strong>Greatly</strong>.</p><p>You can achieve 100% on some datasets.</p><p>And 40% on others. But on those same datasets you can achieve >85% if training on a different number of samples. Or in a different order.</p><p>I guess this is the tradeoff for such a simple and space-efficient algorithm.</p><p>I report my results in the following table. It is not meant to be an exhaustive benchmark of the classifier, since those number will vary based on the order of presentation, but still you can get an idea of what it is able to achieve.</p><table><thead><tr><th>Dataset size</th><th style="text-align: center;">Train samples</th><th style="text-align: right;">Accuracy</th></tr></thead><tbody><tr><td>BREAST CANCER</td><td style="text-align: center;"></td><td style="text-align: right;"></td></tr><tr><td>567 samples</td><td style="text-align: center;">20</td><td style="text-align: right;">62</td></tr><tr><td>30 features</td><td style="text-align: center;">40</td><td style="text-align: right;">37</td></tr><tr><td></td><td style="text-align: center;">60</td><td style="text-align: right;">63</td></tr><tr><td></td><td style="text-align: center;">100</td><td style="text-align: right;">39</td></tr><tr><td></td><td style="text-align: center;">150</td><td style="text-align: right;">38</td></tr><tr><td></td><td style="text-align: center;">200</td><td style="text-align: right;">64</td></tr><tr><td></td><td style="text-align: center;">250</td><td style="text-align: right;">61</td></tr><tr><td></td><td style="text-align: center;">300</td><td style="text-align: right;">69</td></tr><tr><td></td><td style="text-align: center;">350</td><td style="text-align: right;">73</td></tr><tr><td></td><td style="text-align: center;">400</td><td style="text-align: right;">85</td></tr><tr><td>IRIS</td><td style="text-align: center;"></td><td style="text-align: right;"></td></tr><tr><td>100 samples</td><td style="text-align: center;">10</td><td style="text-align: right;">50</td></tr><tr><td>4 features</td><td style="text-align: center;">20</td><td style="text-align: right;">51</td></tr><tr><td></td><td style="text-align: center;">40</td><td style="text-align: right;">100</td></tr><tr><td></td><td style="text-align: center;">60</td><td style="text-align: right;">100</td></tr><tr><td></td><td style="text-align: center;">80</td><td style="text-align: right;">100</td></tr><tr><td>DIGITS</td><td style="text-align: center;"></td><td style="text-align: right;"></td></tr><tr><td>358 samples</td><td style="text-align: center;">20</td><td style="text-align: right;">98</td></tr><tr><td>64 features</td><td style="text-align: center;">40</td><td style="text-align: right;">98</td></tr><tr><td></td><td style="text-align: center;">60</td><td style="text-align: right;">99</td></tr><tr><td></td><td style="text-align: center;">100</td><td style="text-align: right;">100</td></tr><tr><td></td><td style="text-align: center;">150</td><td style="text-align: right;">100</td></tr><tr><td></td><td style="text-align: center;">200</td><td style="text-align: right;">99</td></tr><tr><td></td><td style="text-align: center;">250</td><td style="text-align: right;">98</td></tr><tr><td></td><td style="text-align: center;">300</td><td style="text-align: right;">95</td></tr><tr><td>CLEVELAND HEART DISEASE</td><td style="text-align: center;"></td><td style="text-align: right;"></td></tr><tr><td>212 samples</td><td style="text-align: center;">20</td><td style="text-align: right;">76</td></tr><tr><td>13 features</td><td style="text-align: center;">40</td><td style="text-align: right;">24</td></tr><tr><td></td><td style="text-align: center;">60</td><td style="text-align: right;">77</td></tr><tr><td></td><td style="text-align: center;">100</td><td style="text-align: right;">19</td></tr><tr><td></td><td style="text-align: center;">120</td><td style="text-align: right;">82</td></tr><tr><td></td><td style="text-align: center;">140</td><td style="text-align: right;">78</td></tr><tr><td></td><td style="text-align: center;">180</td><td style="text-align: right;">88</td></tr></tbody></table><h2>Time to code</h2><p>Here I'll report an extract of the example code you can find on <a href="https://github.com/eloquentarduino/EloquentMicroML/blob/master/examples/PassiveAggressiveExample/PassiveAggressiveExample.ino">Github</a> for this classifier.</p><pre><code class="language-c">#include <EloquentPassiveAggressiveClassifier.h>
#include <EloquentAccuracyScorer.h>
#include "iris.h"

using namespace Eloquent::ML;

void loop() {
    int trainSamples;
    PassiveAggressiveClassifier<FEATURES_DIM> clf;
    AccuracyScorer scorer;

    trainSamples = readSerialNumber("How many samples will you use as training?", DATASET_SIZE - 2);

    if (trainSamples == 0)
        return;

    clf.setC(1);

    // train
    for (uint16_t i = 0; i < trainSamples; i++)
        clf.fitOne(X[i], y[i]);

    // predict
    for (uint16_t i = trainSamples; i < DATASET_SIZE; i++) {
        int predicted = clf.predict(X[i]);
        int actual = y[i] > 0 ? 1 : -1;

        scorer.scoreOne(actual, predicted);
    }

    Serial.print("Accuracy: ");
    Serial.print(round(100 * scorer.accuracy()));
    Serial.print("% out of ");
    Serial.print(scorer.support());
    Serial.println(" predictions");
}</code></pre><hr><p>On the <a href="https://github.com/eloquentarduino/EloquentMicroML/blob/master/examples/PassiveAggressiveExample/PassiveAggressiveExample.ino">project page</a> you will find the code to reproduce these numbers.</p><hr></div><div class="heateorSssClear"></div><div class="heateor_sss_sharing_container heateor_sss_horizontal_sharing" heateor-sss-data-href="https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/"><div class="heateor_sss_sharing_title" style="font-weight:bold">Help the blow grow</div><ul class="heateor_sss_sharing_ul"><li class="heateorSssSharingRound"><i style="width:35px;height:35px;border-radius:999px;" alt="Facebook" title="Facebook" class="heateorSssSharing heateorSssFacebookBackground" onclick='heateorSssPopup("https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Feloquent.blog%2F2020%2F04%2Fpassive-aggressive-classifier-for-embedded-devices%2F")'><ss style="display:block;border-radius:999px;" class="heateorSssSharingSvg heateorSssFacebookSvg"></ss></i></li><li class="heateorSssSharingRound"><i style="width:35px;height:35px;border-radius:999px;" alt="Twitter" title="Twitter" class="heateorSssSharing heateorSssTwitterBackground" onclick='heateorSssPopup("http://twitter.com/intent/tweet?via=ArduinoEloquent&text=Passive-aggressive%20classifier%20for%20embedded%20devices&url=http%3A%2F%2Feloquent.blog%2F2020%2F04%2Fpassive-aggressive-classifier-for-embedded-devices%2F")'><ss style="display:block;border-radius:999px;" class="heateorSssSharingSvg heateorSssTwitterSvg"></ss></i></li><li class="heateorSssSharingRound"><i style="width:35px;height:35px;border-radius:999px;" alt="Linkedin" title="Linkedin" class="heateorSssSharing heateorSssLinkedinBackground" onclick='heateorSssPopup("http://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Feloquent.blog%2F2020%2F04%2Fpassive-aggressive-classifier-for-embedded-devices%2F&title=Passive-aggressive%20classifier%20for%20embedded%20devices")'><ss style="display:block;border-radius:999px;" class="heateorSssSharingSvg heateorSssLinkedinSvg"></ss></i></li><li class="heateorSssSharingRound"><i style="width:35px;height:35px;border-radius:999px;" title="More" alt="More" class="heateorSssSharing heateorSssMoreBackground" onclick="heateorSssMoreSharingPopup(this, 'https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/', 'Passive-aggressive%20classifier%20for%20embedded%20devices', '' )"><ss style="display:block" class="heateorSssSharingSvg heateorSssMoreSvg"></ss></i></li></ul><div class="heateorSssClear"></div></div><div class="heateorSssClear"></div><div class="heateor_sss_sharing_container heateor_sss_vertical_sharing heateor_sss_bottom_sharing" style="width:44px;right: -10px;top: 100px;-webkit-box-shadow:none;box-shadow:none;" heateor-sss-data-href="https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/"><ul class="heateor_sss_sharing_ul"><li class=""><i style="width:40px;height:40px;margin:0;" alt="Facebook" title="Facebook" class="heateorSssSharing heateorSssFacebookBackground" onclick='heateorSssPopup("https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Feloquent.blog%2F2020%2F04%2Fpassive-aggressive-classifier-for-embedded-devices%2F")'><ss style="display:block;" class="heateorSssSharingSvg heateorSssFacebookSvg"></ss></i></li><li class=""><i style="width:40px;height:40px;margin:0;" alt="Twitter" title="Twitter" class="heateorSssSharing heateorSssTwitterBackground" onclick='heateorSssPopup("http://twitter.com/intent/tweet?via=ArduinoEloquent&text=Passive-aggressive%20classifier%20for%20embedded%20devices&url=http%3A%2F%2Feloquent.blog%2F2020%2F04%2Fpassive-aggressive-classifier-for-embedded-devices%2F")'><ss style="display:block;" class="heateorSssSharingSvg heateorSssTwitterSvg"></ss></i></li><li class=""><i style="width:40px;height:40px;margin:0;" title="More" alt="More" class="heateorSssSharing heateorSssMoreBackground" onclick="heateorSssMoreSharingPopup(this, 'https://eloquentarduino.github.io/2020/04/passive-aggressive-classifier-for-embedded-devices/', 'Passive-aggressive%20classifier%20for%20embedded%20devices', '' )"><ss style="display:block" class="heateorSssSharingSvg heateorSssMoreSvg"></ss></i></li></ul><div class="heateorSssClear"></div></div><div class="crp_related  "><h3>Related Posts</h3><ul><li><a href="https://eloquentarduino.github.io/2020/03/so-you-want-to-train-an-ml-classifier-directly-on-an-arduino-board/"><span class="crp_title">So you want to train an ML classifier directly on an Arduino board?</span></a></li><li><a href="https://eloquentarduino.github.io/2020/01/image-recognition-with-esp32-and-arduino/"><span class="crp_title">Apple or Orange? Image recognition with ESP32 and Arduino</span></a></li><li><a href="https://eloquentarduino.github.io/2020/03/how-to-train-a-color-classification-machine-learning-classifier-directly-on-your-arduino-board/"><span class="crp_title">How to train a color classification Machine learning classifier directly on your Arduino board</span></a></li><li><a href="https://eloquentarduino.github.io/2020/01/easy-tinyml-on-esp32-and-arduino/"><span class="crp_title">Easy TinyML on ESP32 and Arduino</span></a></li></ul><div class="crp_clear"></div></div><div id="disqus_thread"></div></div><div class="clear"></div></div></div></div><div class="post-meta-bottom"><div class="post-cat-tags"><p class="post-categories"><span>Categories:</span> <a href="https://eloquentarduino.github.io/category/programming/arduino-machine-learning/" rel="category tag">Arduino Machine learning</a></p><p class="post-tags">Tags: <a href="https://eloquentarduino.github.io/tag/microml/" rel="tag">microml</a>, <a href="https://eloquentarduino.github.io/tag/online-learning/" rel="tag">online-learning</a></p></div><div class="archive-nav post-nav"> <a class="post-nav-older" title="Previous post: How to train a color classification Machine learning classifier directly on your Arduino board" href="https://eloquentarduino.github.io/2020/03/how-to-train-a-color-classification-machine-learning-classifier-directly-on-your-arduino-board/"> « How to train a color classification Machine learning classifier directly on your Arduino board </a> <a class="post-nav-newer" title="Next post: Stochastic Gradient Descent on your microcontroller" href="https://eloquentarduino.github.io/2020/04/stochastic-gradient-descent-on-your-microcontroller/"> Stochastic Gradient Descent on your microcontroller » </a><div class="clear"></div></div></div><p class="nocomments">Comments are closed.</p><div class="footer section large-padding bg-dark"><div class="clear"></div></div><div class="credits"><div class="credits-inner"><p class="credits-left">© 2020 <a href="https://eloquentarduino.github.io" title="Eloquent Arduino Blog">Eloquent Arduino Blog</a></p><p class="credits-right"><span>Theme by <a href="https://www.andersnoren.se">Anders Norén</a></span> — <a title="To the top" class="tothetop">Up ↑</a></p><div class="clear"></div></div></div></div><div class="clear"></div></div><link href="https://fonts.googleapis.com/css?family=Lato:400,700&display=swap" rel="stylesheet"> <script src="//cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script> <script src="//cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-154550080-1"></script> <script>if (window.location.href.indexOf("eloquent.blog") < 0) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-154550080-1');
}</script>  <script>(function() {
setTimeout(function() {
  var d = document, s = d.createElement('script');
  s.src = 'https://eloquent-arduino.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);},
10000);
})();</script>   <script src="/assets/app.js"></script> <link rel="stylesheet" id="fontawesome5-css" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" type="text/css" media="all"> <script type="text/javascript">/*  */
var highlight_and_share = {"show_facebook":"1","show_twitter":"1","show_linkedin":"1","show_pinterest":"","show_email":"","show_xing":"","show_copy":"","show_whatsapp":"","twitter_username":"EloquentArduino","twitter_fa_class":"fa fa-twitter","facebook_fa_class":"fa fa-facebook","linkedin_fa_class":"fa fa-linkedin","pinterest_fa_class":"fa fa-pinterest","xing_fa_class":"fa fa-xing","whatsapp_fa_class":"fa fa-whatsapp","copy_fa_class":"fa fa-copy","email_fa_class":"fa fa-envelope","mobile":"","content":".has-content-area","tweet_text":"Tweet","facebook_text":"Share","linkedin_text":"LinkedIn","pinterest_text":"Pinterest","whatsapp_text":"WhatsApp","xing_text":"Xing","copy_text":"Copy","email_text":"E-mail","icons":"1","facebook_app_id":"2530754057166153","email_your_name_value":"","email_from_value":"","nonce":"7377248110","ajax_url":"https:\/\/eloquentarduino.github.io\/wp-admin\/admin-ajax.php","email_share":"Share This Post Via Email","email_subject":"Your Subject","email_your_name":"Your Name","email_send_email":"Send to Email Address","email_subject_text":"[Shared Post] %title%","email_from":"Your Email Address","email_send":"Send Email","email_cancel":"Cancel","email_close":"Close","email_loading":"https:\/\/eloquentarduino.github.io\/wp-content\/plugins\/highlight-and-share\/img\/loading.gif","email_subject_error":"You must fill in a subject.","email_email_to":"Send to Email Address is blank.","email_email_from":"Your email address is blank.","email_email_name":"Your name is blank.","email_sending":"Sending...","customizer_preview":""};
/*  */</script> <script type="text/javascript" src="https://eloquentarduino.github.io/wp-content/uploads/cache/fvm/1586711349/out/footer-2a0ba29699ca749ee9d64b32d3abd1949bdb0ade.min.js"></script><script>/* loadCSS. [c]2017 Filament Group, Inc. MIT License */
(function(w){if(!w.loadCSS)w.loadCSS=function(){};var rp=loadCSS.relpreload={};rp.support=function(){var ret;try{ret=w.document.createElement("link").relList.supports("preload")}catch(e){ret=false}return function(){return ret}}();rp.bindMediaToggle=function(link){var finalMedia=link.media||"all";function enableStylesheet(){if(link.addEventListener)link.removeEventListener("load",enableStylesheet);else if(link.attachEvent)link.detachEvent("onload",enableStylesheet);link.setAttribute("onload",null);link.media=finalMedia}if(link.addEventListener)link.addEventListener("load",enableStylesheet);else if(link.attachEvent)link.attachEvent("onload",enableStylesheet);setTimeout(function(){link.rel="stylesheet";link.media="only x"});setTimeout(enableStylesheet,3E3)};rp.poly=function(){if(rp.support())return;var links=w.document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var link=links[i];if(link.rel==="preload"&&link.getAttribute("as")==="style"&&!link.getAttribute("data-loadcss")){link.setAttribute("data-loadcss", true);rp.bindMediaToggle(link)}}};if(!rp.support()){rp.poly();var run=w.setInterval(rp.poly,500);if(w.addEventListener)w.addEventListener("load",function(){rp.poly();w.clearInterval(run)});else if(w.attachEvent)w.attachEvent("onload",function(){rp.poly();w.clearInterval(run)})}if(typeof exports!=="undefined")exports.loadCSS=loadCSS;else w.loadCSS=loadCSS})(typeof global!=="undefined"?global:this);</script> </body></html>
