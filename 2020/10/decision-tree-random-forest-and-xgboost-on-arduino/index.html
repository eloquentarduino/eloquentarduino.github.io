<!DOCTYPE html>
<html lang="en-US"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta property="og:title" content="Decision Tree, Random Forest and XGBoost on Arduino"><meta property="og:description" content="You will be surprised by how much accuracy you can achieve in just a few kylobytes of resources: **Decision Tree, Random Forest and XGBoost (Extreme Gradient Bo"><meta property="og:image" content="https://eloquentarduino.github.io/wp-content/uploads/2020/08/DecisionTree.png"><meta property="og:image:width" content="1284"><meta property="og:image:height" content="902"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Decision Tree, Random Forest and XGBoost on Arduino"><meta name="twitter:description" content="You will be surprised by how much accuracy you can achieve in just a few kylobytes of resources: **Decision Tree, Random Forest and XGBoost (Extreme Gradient Bo"><meta name="twitter:image" content="https://eloquentarduino.github.io/wp-content/uploads/2020/08/DecisionTree.png"><meta name="author" content="simone"><link rel="stylesheet" media="print" onload="this.onload=null;this.media='all';" id="ao_optimized_gfonts" href="https://fonts.googleapis.com/css?family=Lato%3A400%2C700%2C400italic%2C700italic%7CLato:400,700&display=swap"><link media="all" href="https://eloquentarduino.github.io/wp-content/cache/autoptimize/css/autoptimize_a472e90631480a21513db05693ae6925.css" rel="stylesheet"><title>Decision Tree, Random Forest and XGBoost on Arduino</title><meta name="robots" content="index, follow"><meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:url" content="https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/"><meta property="og:site_name" content="Eloquent Arduino Blog"><meta property="article:published_time" content="2020-10-19T17:31:02+00:00"><meta property="article:modified_time" content="2020-10-21T11:59:20+00:00"><meta property="og:image" content="https://eloquentarduino.github.io/wp-content/uploads/2020/08/DecisionTree.png"><meta property="og:image:width" content="1284"><meta property="og:image:height" content="902"> <script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://eloquentarduino.github.io/#website","url":"https://eloquentarduino.github.io/","name":"Eloquent Arduino Blog","description":"Machine learning on Arduino, programming & electronics","publisher":{"@id":"https://eloquentarduino.github.io/#/schema/person/c35265597251f0133ecca5b413d12901"},"potentialAction":[{"@type":"SearchAction","target":"https://eloquentarduino.github.io/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/#primaryimage","inLanguage":"en-US","url":"https://eloquentarduino.github.io/wp-content/uploads/2020/08/DecisionTree.png","width":1284,"height":902,"caption":"DecisionTree"},{"@type":"WebPage","@id":"https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/#webpage","url":"https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/","name":"Decision Tree, Random Forest and XGBoost on Arduino","isPartOf":{"@id":"https://eloquentarduino.github.io/#website"},"primaryImageOfPage":{"@id":"https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/#primaryimage"},"datePublished":"2020-10-19T17:31:02+00:00","dateModified":"2020-10-21T11:59:20+00:00","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/"]}]},{"@type":"Article","@id":"https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/#article","isPartOf":{"@id":"https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/#webpage"},"author":{"@id":"https://eloquentarduino.github.io/#/schema/person/c35265597251f0133ecca5b413d12901"},"headline":"Decision Tree, Random Forest and XGBoost on Arduino","datePublished":"2020-10-19T17:31:02+00:00","dateModified":"2020-10-21T11:59:20+00:00","mainEntityOfPage":{"@id":"https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/#webpage"},"publisher":{"@id":"https://eloquentarduino.github.io/#/schema/person/c35265597251f0133ecca5b413d12901"},"image":{"@id":"https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/#primaryimage"},"keywords":"microml,ml","articleSection":"Arduino Machine learning,Arduino Machine Learning tutorial","inLanguage":"en-US"},{"@type":["Person","Organization"],"@id":"https://eloquentarduino.github.io/#/schema/person/c35265597251f0133ecca5b413d12901","name":"simone","image":{"@type":"ImageObject","@id":"https://eloquentarduino.github.io/#personlogo","inLanguage":"en-US","url":"https://eloquentarduino.github.io/wp-content/uploads/2019/12/avatar.jpg","width":330,"height":330,"caption":"simone"},"logo":{"@id":"https://eloquentarduino.github.io/#personlogo"}}]}</script> <link rel="dns-prefetch" href="//use.fontawesome.com"><link rel="dns-prefetch" href="//s.w.org"><link href="https://fonts.gstatic.com" crossorigin="anonymous" rel="preconnect"><link rel="stylesheet" id="font-awesome-official-css" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css" type="text/css" media="all" integrity="sha384-REHJTs1r2ErKBuJB0fCK99gCYsVjwxHrSU0N7I1zl9vZbggVJXRMsv/sLlOAGb4M" crossorigin="anonymous"><link rel="stylesheet" id="font-awesome-official-v4shim-css" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css" type="text/css" media="all" integrity="sha384-AL44/7DEVqkvY9j8IjGLGZgFmHAjuHa+2RIWKxDliMNIfSs9g14/BRpYwHrWQgz6" crossorigin="anonymous"> <script type="text/javascript" src="https://eloquentarduino.github.io/wp-includes/js/jquery/jquery.js"></script> <meta name="google-site-verification" content="xgigjPrbbYDemskTaGLT9WGhmw8wgdeFtpDxVak0awI"></head><body class="post-template-default single single-post postid-1264 single-format-standard has-body"><div class="wrapper"><div class="sidebar"><div class="blog-header"> <a class="blog-logo" href="https://eloquentarduino.github.io" title="Eloquent Arduino Blog — Machine learning on Arduino, programming & electronics" rel="home"> <noscript><img src="https://eloquentarduino.github.io/wp-content/uploads/2019/12/logo-completo.png" alt="Eloquent Arduino Blog"></noscript><img class="lazyload" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20210%20140%22%3E%3C/svg%3E" data-src="https://eloquentarduino.github.io/wp-content/uploads/2019/12/logo-completo.png" alt="Eloquent Arduino Blog"> </a></div><div class="nav-toggle toggle"><p> <span class="show">Show menu</span> <span class="hide">Hide menu</span></p><div class="bars"><div class="bar"></div><div class="bar"></div><div class="bar"></div><div class="clear"></div></div></div><div class="blog-menu"><ul class="navigation"><li id="menu-item-461" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-461"><a href="https://eloquentarduino.github.io/category/programming/arduino-machine-learning/">Arduino Machine learning</a></li><li id="menu-item-462" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-462"><a href="https://eloquentarduino.github.io/category/programming/eloquent-library/">Eloquent library</a></li></ul><div class="clear"></div></div><div class="mobile-menu"><ul class="navigation"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-461"><a href="https://eloquentarduino.github.io/category/programming/arduino-machine-learning/">Arduino Machine learning</a></li><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-462"><a href="https://eloquentarduino.github.io/category/programming/eloquent-library/">Eloquent library</a></li></ul></div><div class="widgets" role="complementary"><div class="widget_text widget widget_custom_html"><div class="widget_text widget-content"><div class="textwidget custom-html-widget"><div style="text-align: center"> <noscript><img src="/wp-content/uploads/2020/04/profilo.png" alt="Profile pic" style="width: 125px"></noscript><img class="lazyload" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20210%20140%22%3E%3C/svg%3E" data-src="/wp-content/uploads/2020/04/profilo.png" alt="Profile pic" style="width: 125px"> <a href="/about-me" style="display: block; font-size: 18px">About me</a></div></div></div><div class="clear"></div></div><div class="widget widget_search"><div class="widget-content"><form method="get" class="searchform" action="https://eloquentarduino.github.io" id="searchform"><div role="search" class="searchbox__wrapper"> <input id="search-input" type="search" name="search" placeholder="Search the blog" autocomplete="off" required="required" class="searchbox__input"> <button type="submit" title="Submit your search query." class="searchbox__submit"> <svg role="img" aria-label="Search"> <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#sbx-icon-search-13"></use> </svg> </button> <button type="reset" title="Clear the search query." class="searchbox__reset hide"> <svg role="img" aria-label="Reset"> <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#sbx-icon-clear-3"></use> </svg> </button></div></form></div><div class="clear"></div></div><div class="widget widget_recent_entries"><div class="widget-content"><h3 class="widget-title">Recent Posts</h3><ul><li> <a href="https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/" aria-current="page">Decision Tree, Random Forest and XGBoost on Arduino</a></li><li> <a href="https://eloquentarduino.github.io/2020/09/principal-fft-components-as-efficient-features-extrator/">“Principal” FFT components as efficient features extrator</a></li><li> <a href="https://eloquentarduino.github.io/2020/08/better-word-classification-with-arduino-33-ble-sense-and-machine-learning/">Better word classification with Arduino Nano 33 BLE Sense and Machine Learning</a></li><li> <a href="https://eloquentarduino.github.io/2020/08/the-ultimate-guide-to-wifi-indoor-positioning-using-arduino-and-machine-learning/">The Ultimate Guide to Wifi Indoor Positioning using Arduino and Machine Learning</a></li><li> <a href="https://eloquentarduino.github.io/2020/08/eloquentml-grows-its-family-of-classifiers-gaussian-naive-bayes-on-arduino/">EloquentML grows its family of classifiers: Gaussian Naive Bayes on Arduino</a></li></ul></div><div class="clear"></div></div><div class="widget widget_sub_categories"><div class="widget-content"><h3 class="widget-title">Programming</h3><ul><li class="cat-item cat-item-8"><a href="https://eloquentarduino.github.io/category/programming/arduino-machine-learning/">Arduino Machine learning</a><ul class="children"><li class="cat-item cat-item-24"><a href="https://eloquentarduino.github.io/category/programming/arduino-machine-learning/arduino-machine-learning-tutorial/">Arduino Machine Learning tutorial</a></li></ul></li><li class="cat-item cat-item-12"><a href="https://eloquentarduino.github.io/category/programming/computer-vision/">Computer vision</a></li><li class="cat-item cat-item-7"><a href="https://eloquentarduino.github.io/category/programming/eloquent-library/">Eloquent library</a></li></ul></div><div class="clear"></div></div><div class="widget widget_tag_cloud"><div class="widget-content"><h3 class="widget-title">TAGS</h3><div class="tagcloud"><a href="https://eloquentarduino.github.io/tag/camera/" class="tag-cloud-link tag-link-11 tag-link-position-1" style="font-size: 14.222222222222pt;" aria-label="camera (5 items)">camera</a> <a href="https://eloquentarduino.github.io/tag/eloquent/" class="tag-cloud-link tag-link-4 tag-link-position-2" style="font-size: 11.888888888889pt;" aria-label="eloquent (3 items)">eloquent</a> <a href="https://eloquentarduino.github.io/tag/esp32/" class="tag-cloud-link tag-link-10 tag-link-position-3" style="font-size: 14.222222222222pt;" aria-label="esp32 (5 items)">esp32</a> <a href="https://eloquentarduino.github.io/tag/incremental-learning/" class="tag-cloud-link tag-link-16 tag-link-position-4" style="font-size: 8pt;" aria-label="incremental-learning (1 item)">incremental-learning</a> <a href="https://eloquentarduino.github.io/tag/microml/" class="tag-cloud-link tag-link-5 tag-link-position-5" style="font-size: 22pt;" aria-label="microml (23 items)">microml</a> <a href="https://eloquentarduino.github.io/tag/ml/" class="tag-cloud-link tag-link-17 tag-link-position-6" style="font-size: 14.222222222222pt;" aria-label="ml (5 items)">ml</a> <a href="https://eloquentarduino.github.io/tag/online-learning/" class="tag-cloud-link tag-link-15 tag-link-position-7" style="font-size: 10.333333333333pt;" aria-label="online-learning (2 items)">online-learning</a> <a href="https://eloquentarduino.github.io/tag/pca/" class="tag-cloud-link tag-link-21 tag-link-position-8" style="font-size: 8pt;" aria-label="pca (1 item)">pca</a> <a href="https://eloquentarduino.github.io/tag/rvm/" class="tag-cloud-link tag-link-13 tag-link-position-9" style="font-size: 8pt;" aria-label="rvm (1 item)">rvm</a> <a href="https://eloquentarduino.github.io/tag/svm/" class="tag-cloud-link tag-link-14 tag-link-position-10" style="font-size: 18.111111111111pt;" aria-label="svm (11 items)">svm</a> <a href="https://eloquentarduino.github.io/tag/tinyml/" class="tag-cloud-link tag-link-20 tag-link-position-11" style="font-size: 8pt;" aria-label="tinyml (1 item)">tinyml</a></div></div><div class="clear"></div></div></div></div><div class="content"><div class="posts"><div id="post-1264" class="post-1264 post type-post status-publish format-standard hentry category-arduino-machine-learning category-arduino-machine-learning-tutorial tag-microml tag-ml"><div class="post-inner"><div class="post-header"><h1 class="post-title"><a href="https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/" rel="bookmark" title="Decision Tree, Random Forest and XGBoost on Arduino">Decision Tree, Random Forest and XGBoost on Arduino</a></h1><div class="post-meta"> <span class="post-date"><a href="https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/" title="Decision Tree, Random Forest and XGBoost on Arduino">19 October 2020</a></span> <span class="date-sep"> / </span> <span class="post-author"><a href="https://eloquentarduino.github.io/author/simone/" title="Posts by simone" rel="author">simone</a></span></div></div><div class="post-content"><div class="has-content-area" data-url="https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/" data-title="Decision Tree, Random Forest and XGBoost on Arduino"><p>You will be surprised by how much accuracy you can achieve in just a few kylobytes of resources: <strong>Decision Tree, Random Forest and XGBoost (Extreme Gradient Boosting)</strong> are now available on your microcontrollers: highly RAM-optmized implementations for super-fast classification on embedded devices.</p><p><noscript><img src="https://eloquentarduino.github.io/wp-content/uploads/2020/08/DecisionTree.png" alt="DecisionTree"></noscript><img class="lazyload" src="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20210%20140%22%3E%3C/svg%3E" data-src="https://eloquentarduino.github.io/wp-content/uploads/2020/08/DecisionTree.png" alt="DecisionTree"></p><p><span id="more-1264"></span></p><h2>Decision Tree</h2><p><strong>Decision Tree</strong> is without doubt one of the most well-known classification algorithms out there. It is so simple to understand that it was probably the first classifier you encountered in any Machine Learning course.</p><p>I won't go into the details of how a Decision Tree classifier trains and selects the splits for the input features: here I will explain how a RAM-efficient porting of such a classifier is implemented.</p><p>To an introduction visit <a href="https://en.wikipedia.org/wiki/Decision_tree_learning">Wikipedia</a>; for a more in-depth guide visit <a href="https://www.kdnuggets.com/2020/01/decision-tree-algorithm-explained.html">KDNuggets</a>.</p><p>Since we're willing to sacrifice program space (a.k.a flash) in favor of memory (a.k.a RAM), because RAM is the most scarce resource in the vast majority of microcontrollers, the smart way to port a Decision Tree classifier from Python to C is "hard-coding" the splits in code, without keeping any reference to them into variables.</p><p>Here's what it looks like for a Decision tree that classifies the Iris dataset.</p><p>As you can see, we're using <strong>0 bytes of RAM</strong> to get the classification result, since no variable is being allocated. On the other side, the program space will grow almost linearly with the number of splits.</p><p>Since program space is often much greater than RAM on microcontrollers, this implementation exploits its abundance to be able to deploy larger models. How much large? It will depend on the flash size available: many new generations board (Arduino Nano 33 BLE Sense, ESP32, ST Nucleus...) have 1 Mb of flash, which will hold tens of thousands of splits.</p><h2>Random Forest</h2><p><strong><a href="https://en.wikipedia.org/wiki/Random_forest">Random Forest</a></strong> is just many Decision Trees joined together in a voting scheme. The core idea is that of <em>"the wisdom of the corwd"</em>, such that if many trees vote for a given class (having being trained on different subsets of the training set), that class is probably the true class.</p><p><a href="https://towardsdatascience.com/understanding-random-forest-58381e0602d2">Towards Data Science</a> has a more detailed guide on Random Forest and how it balances the trees with the<em>bagging</em> tecnique.</p><p>As easy as Decision Trees, Random Forest gets the exact same implementation with <strong>0 bytes of RAM</strong> required (it actually needs as many bytes as the number of classes to store the votes, but that's really negligible): it just hard-codes all its composing trees.</p><h2>XGBoost (Extreme Gradient Boosting)</h2><p>Extreme Gradient Boosting is <em>"Gradient Boosting on steroids"</em> and has gained much attention from the Machine learning community due to its top results in many data competitions.</p><ol><li>"gradient boosting" refers to the process of chaining a number of trees so that each tree tries to learn from the errors of the previous</li><li>"extreme" refers to many software and hardware optimizations that greatly reduce the time it takes to train the model</li></ol><p>You can read <a href="https://www.kdd.org/kdd2016/papers/files/rfp0697-chenAemb.pdf">the original paper about XGBoost here</a>. For a discursive description head to <a href="https://www.kdnuggets.com/2019/05/xgboost-algorithm.html">KDNuggets</a>, if you want some more math refer to <a href="https://medium.com/@gabrieltseng/gradient-boosting-and-xgboost-c306c1bcfaf5">this blog post on Medium</a>.</p><h2>Porting to plain C</h2><p>If you followed my earlier posts on <a href="/2020/08/eloquentml-grows-its-family-of-classifiers-gaussian-naive-bayes-on-arduino/">Gaussian Naive Bayes</a>, <a href="https://eloquentarduino.github.io/2020/07/sefr-a-fast-linear-time-classifier-for-ultra-low-power-devices/">SEFR</a>, <a href="/2020/02/even-smaller-machine-learning-models-for-your-mcu/">Relevant Vector Machine</a> and <a href="/2019/11/you-can-run-machine-learning-on-arduino/">Support Vector Machines</a>, you already know how to port these new classifiers.</p><p>If you're new, you will need a couple things:</p><ol><li>install the <a href="https://pypi.org/project/micromlgen/">micromlgen</a> package with</li></ol><pre><code class="language-bash">pip install micromlgen</code></pre><ol start="2"><li>(optionally, if you want to use Extreme Gradient Boosting) install the <a href="https://pypi.org/project/xgboost/">xgboost</a> package with</li></ol><pre><code class="language-bash">pip install xgboost</code></pre><ol start="3"><li>use the <code>micromlgen.port</code> function to generate your plain C code</li></ol><pre><code class="language-python">from micromlgen import port
from sklearn.tree import DecisionTreeClassifier
from sklearn.datasets import load_iris

clf = DecisionTreeClassifier
X, y = load_iris(return_X_y=True)
clf.fit(X, y)
print(port(clf))</code></pre><p>You can then copy-past the C code and import it in your sketch.</p><h2>Using in the Arduino sketch</h2><p>Once you have the classifier code, create a new project named <code>TreeClassifierExample</code> and copy the classifier code into a file named <code>DecisionTree.h</code> (or <code>RandomForest.h</code> or <code>XGBoost.h</code> depending on the model you chose).</p><p>The copy the following to the main ino file.</p><pre><code class="language-cpp">#include "DecisionTree.h"

Eloquent::ML::Port::DecisionTree clf;

void setup() {
    Serial.begin(115200);
    Serial.println("Begin");
}

void loop() {
    float irisSample[4] = {6.2, 2.8, 4.8, 1.8};

    Serial.print("Predicted label (you should see '2': ");
    Serial.println(clf.predict(irisSample));
    delay(1000);
}</code></pre><h2>Bechmarks</h2><p>How do the 3 classifiers compare against each other?</p><p>We will evaluate a few keypoints:</p><ul><li>training time</li><li>accuracy</li><li>needed RAM</li><li>needed Flash</li></ul><p>for each classifier on a variety of datasets. I will report the results for RAM and Flash on the Arduino Nano old generation, so you should consider more the relative figures than the absolute ones.</p><table><thead><tr><th>Dataset</th><th style="text-align: center;">Classifier</th><th style="text-align: center;">Training <br>time (s)</th><th style="text-align: center;">Accuracy</th><th style="text-align: center;">RAM <br>(bytes)</th><th style="text-align: center;">Flash <br>(bytes)</th></tr></thead><tbody><tr><td><strong>Gas Sensor Array Drift Dataset </strong></td><td style="text-align: center;">Decision Tree</td><td style="text-align: center;">1,6</td><td style="text-align: center;">0.781 ± 0.12</td><td style="text-align: center;">290</td><td style="text-align: center;">5722</td></tr><tr><td>13910 samples x 128 features</td><td style="text-align: center;">Random Forest</td><td style="text-align: center;">3</td><td style="text-align: center;">0.865 ± 0.083</td><td style="text-align: center;">290</td><td style="text-align: center;">6438</td></tr><tr><td>6 classes</td><td style="text-align: center;">XGBoost</td><td style="text-align: center;">18,8</td><td style="text-align: center;"><strong>0.878 ± 0.074</strong></td><td style="text-align: center;">290</td><td style="text-align: center;">6506</td></tr><tr><td><strong>Gesture Phase Segmentation Dataset</strong></td><td style="text-align: center;">Decision Tree</td><td style="text-align: center;">0,1</td><td style="text-align: center;">0.943 ± 0.005</td><td style="text-align: center;">290</td><td style="text-align: center;">5638</td></tr><tr><td>10000 samples x 19 features</td><td style="text-align: center;">Random Forest</td><td style="text-align: center;">0,7</td><td style="text-align: center;"><strong>0.970 ± 0.004</strong></td><td style="text-align: center;">306</td><td style="text-align: center;">6466</td></tr><tr><td>5 classes</td><td style="text-align: center;">XGBoost</td><td style="text-align: center;">18,9</td><td style="text-align: center;">0.969 ± 0.003</td><td style="text-align: center;">306</td><td style="text-align: center;">6536</td></tr><tr><td><strong>Drive Diagnosis Dataset</strong></td><td style="text-align: center;">Decision Tree</td><td style="text-align: center;">0,6</td><td style="text-align: center;">0.946 ± 0.005</td><td style="text-align: center;">306</td><td style="text-align: center;">5850</td></tr><tr><td>10000 samples x 48 features</td><td style="text-align: center;">Random Forest</td><td style="text-align: center;">2,6</td><td style="text-align: center;"><strong>0.983 ± 0.003</strong></td><td style="text-align: center;">306</td><td style="text-align: center;">6526</td></tr><tr><td>11 classes</td><td style="text-align: center;">XGBoost</td><td style="text-align: center;">68,9</td><td style="text-align: center;">0.977 ± 0.005</td><td style="text-align: center;">306</td><td style="text-align: center;">6698</td></tr></tbody></table><p>* <em>all datasets are taken from the <a href="https://archive.ics.uci.edu/ml//datasets.php">UCI Machine Learning datasets archive</a></em></p><p>I'm collecting more data for a complete benchmark, but in the meantime you can see that both Random Forest and XGBoost are on par: if not that XGBoost takes 5 to 25 times longer to train.</p><p>I've never used XGBoost, so I may be missing some tuning parameters, but for now Random Forest remains my favourite classifier.</p><h2>Code listings</h2><pre><code class="language-cpp">// example IRIS dataset classification with Decision Tree
int predict(float *x) {
  if (x[3] <= 0.800000011920929) {
      return 0;
  }
  else {
      if (x[3] <= 1.75) {
          if (x[2] <= 4.950000047683716) {
              if (x[0] <= 5.049999952316284) {
                  return 1;
              }
              else {
                  return 1;
              }
          }
          else {
              return 2;
          }
      }
      else {
          if (x[2] <= 4.950000047683716) {
              return 2;
          }
          else {
              return 2;
          }
      }
  }
}</code></pre><pre><code class="language-cpp">// example IRIS dataset classification with Random Forest of 3 trees

int predict(float *x) {
  uint16_t votes[3] = { 0 };

  // tree #1
  if (x[0] <= 5.450000047683716) {
      if (x[1] <= 2.950000047683716) {
          votes[1] += 1;
      }
      else {
          votes[0] += 1;
      }
  }
  else {
      if (x[0] <= 6.049999952316284) {
          if (x[3] <= 1.699999988079071) {
              if (x[2] <= 3.549999952316284) {
                  votes[0] += 1;
              }
              else {
                  votes[1] += 1;
              }
          }
          else {
              votes[2] += 1;
          }
      }
      else {
          if (x[3] <= 1.699999988079071) {
              if (x[3] <= 1.449999988079071) {
                  if (x[0] <= 6.1499998569488525) {
                      votes[1] += 1;
                  }
                  else {
                      votes[1] += 1;
                  }
              }
              else {
                  votes[1] += 1;
              }
          }
          else {
              votes[2] += 1;
          }
      }
  }

  // tree #2
  if (x[0] <= 5.549999952316284) {
      if (x[2] <= 2.449999988079071) {
          votes[0] += 1;
      }
      else {
          if (x[2] <= 3.950000047683716) {
              votes[1] += 1;
          }
          else {
              votes[1] += 1;
          }
      }
  }
  else {
      if (x[3] <= 1.699999988079071) {
          if (x[1] <= 2.649999976158142) {
              if (x[3] <= 1.25) {
                  votes[1] += 1;
              }
              else {
                  votes[1] += 1;
              }
          }
          else {
              if (x[2] <= 4.1499998569488525) {
                  votes[1] += 1;
              }
              else {
                  if (x[0] <= 6.75) {
                      votes[1] += 1;
                  }
                  else {
                      votes[1] += 1;
                  }
              }
          }
      }
      else {
          if (x[0] <= 6.0) {
              votes[2] += 1;
          }
          else {
              votes[2] += 1;
          }
      }
  }

  // tree #3
  if (x[3] <= 1.75) {
      if (x[2] <= 2.449999988079071) {
          votes[0] += 1;
      }
      else {
          if (x[2] <= 4.8500001430511475) {
              if (x[0] <= 5.299999952316284) {
                  votes[1] += 1;
              }
              else {
                  votes[1] += 1;
              }
          }
          else {
              votes[1] += 1;
          }
      }
  }
  else {
      if (x[0] <= 5.950000047683716) {
          votes[2] += 1;
      }
      else {
          votes[2] += 1;
      }
  }

  // return argmax of votes
  uint8_t classIdx = 0;
  float maxVotes = votes[0];

  for (uint8_t i = 1; i < 3; i++) {
      if (votes[i] > maxVotes) {
          classIdx = i;
          maxVotes = votes[i];
      }
  }

  return classIdx;
}</code></pre></div><div class="heateorSssClear"></div><div class="heateor_sss_sharing_container heateor_sss_horizontal_sharing" heateor-sss-data-href="https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/"><div class="heateor_sss_sharing_title" style="font-weight:bold">Help the blow grow</div><ul class="heateor_sss_sharing_ul"><li class="heateorSssSharingRound"><i style="width:35px;height:35px;border-radius:999px;" alt="Facebook" title="Facebook" class="heateorSssSharing heateorSssFacebookBackground" onclick='heateorSssPopup("https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Feloquent.blog%2F2020%2F10%2Fdecision-tree-random-forest-and-xgboost-on-arduino%2F")'><ss style="display:block;border-radius:999px;" class="heateorSssSharingSvg heateorSssFacebookSvg"></ss></i></li><li class="heateorSssSharingRound"><i style="width:35px;height:35px;border-radius:999px;" alt="Twitter" title="Twitter" class="heateorSssSharing heateorSssTwitterBackground" onclick='heateorSssPopup("http://twitter.com/intent/tweet?via=ArduinoEloquent&text=Decision%20Tree%2C%20Random%20Forest%20and%20XGBoost%20on%20your%20Arduino%20microcontroller&url=http%3A%2F%2Feloquent.blog%2F2020%2F10%2Fdecision-tree-random-forest-and-xgboost-on-arduino%2F")'><ss style="display:block;border-radius:999px;" class="heateorSssSharingSvg heateorSssTwitterSvg"></ss></i></li><li class="heateorSssSharingRound"><i style="width:35px;height:35px;border-radius:999px;" alt="Linkedin" title="Linkedin" class="heateorSssSharing heateorSssLinkedinBackground" onclick='heateorSssPopup("http://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Feloquent.blog%2F2020%2F10%2Fdecision-tree-random-forest-and-xgboost-on-arduino%2F&title=Decision%20Tree%2C%20Random%20Forest%20and%20XGBoost%20on%20Arduino")'><ss style="display:block;border-radius:999px;" class="heateorSssSharingSvg heateorSssLinkedinSvg"></ss></i></li><li class="heateorSssSharingRound"><i style="width:35px;height:35px;border-radius:999px;" title="More" alt="More" class="heateorSssSharing heateorSssMoreBackground" onclick="heateorSssMoreSharingPopup(this, 'https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/', 'Decision%20Tree%2C%20Random%20Forest%20and%20XGBoost%20on%20Arduino', 'Decision%20Tree%2C%20Random%20Forest%20and%20XGBoost%20on%20your%20Arduino%20microcontroller' )"><ss style="display:block" class="heateorSssSharingSvg heateorSssMoreSvg"></ss></i></li></ul><div class="heateorSssClear"></div></div><div class="heateorSssClear"></div><div class="heateor_sss_sharing_container heateor_sss_vertical_sharing heateor_sss_bottom_sharing" style="width:44px;right: -10px;top: 100px;-webkit-box-shadow:none;box-shadow:none;" heateor-sss-data-href="https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/"><ul class="heateor_sss_sharing_ul"><li class=""><i style="width:40px;height:40px;margin:0;" alt="Facebook" title="Facebook" class="heateorSssSharing heateorSssFacebookBackground" onclick='heateorSssPopup("https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Feloquent.blog%2F2020%2F10%2Fdecision-tree-random-forest-and-xgboost-on-arduino%2F")'><ss style="display:block;" class="heateorSssSharingSvg heateorSssFacebookSvg"></ss></i></li><li class=""><i style="width:40px;height:40px;margin:0;" alt="Twitter" title="Twitter" class="heateorSssSharing heateorSssTwitterBackground" onclick='heateorSssPopup("http://twitter.com/intent/tweet?via=ArduinoEloquent&text=Decision%20Tree%2C%20Random%20Forest%20and%20XGBoost%20on%20your%20Arduino%20microcontroller&url=http%3A%2F%2Feloquent.blog%2F2020%2F10%2Fdecision-tree-random-forest-and-xgboost-on-arduino%2F")'><ss style="display:block;" class="heateorSssSharingSvg heateorSssTwitterSvg"></ss></i></li><li class=""><i style="width:40px;height:40px;margin:0;" title="More" alt="More" class="heateorSssSharing heateorSssMoreBackground" onclick="heateorSssMoreSharingPopup(this, 'https://eloquentarduino.github.io/2020/10/decision-tree-random-forest-and-xgboost-on-arduino/', 'Decision%20Tree%2C%20Random%20Forest%20and%20XGBoost%20on%20Arduino', 'Decision%20Tree%2C%20Random%20Forest%20and%20XGBoost%20on%20your%20Arduino%20microcontroller' )"><ss style="display:block" class="heateorSssSharingSvg heateorSssMoreSvg"></ss></i></li></ul><div class="heateorSssClear"></div></div><div class="crp_related  "><h3>Related Posts</h3><ul><li><a href="https://eloquentarduino.github.io/2020/08/better-word-classification-with-arduino-33-ble-sense-and-machine-learning/" class="post-1282"><span class="crp_title">Better word classification with Arduino Nano 33 BLE Sense and Machine Learning</span></a></li><li><a href="https://eloquentarduino.github.io/2020/04/incremental-multiclass-classification-on-microcontrollers-one-vs-one/" class="post-1079"><span class="crp_title">Incremental multiclass classification on microcontrollers: One vs One</span></a></li><li><a href="https://eloquentarduino.github.io/2020/06/arduino-dimensionality-reduction-pca-for-machine-learning-projects/" class="post-1174"><span class="crp_title">Arduino dimensionality reduction (PCA) for Machine Learning projects</span></a></li><li><a href="https://eloquentarduino.github.io/2020/05/anomaly-detection-on-your-arduino-microcontroller-via-one-class-svm/" class="post-1156"><span class="crp_title">Anomaly detection on your Arduino microcontroller via One Class SVM</span></a></li></ul><div class="crp_clear"></div></div><div id="disqus_thread"></div></div><div class="clear"></div></div></div></div><div class="post-meta-bottom"><div class="post-cat-tags"><p class="post-categories"><span>Categories:</span> <a href="https://eloquentarduino.github.io/category/programming/arduino-machine-learning/" rel="category tag">Arduino Machine learning</a>, <a href="https://eloquentarduino.github.io/category/programming/arduino-machine-learning/arduino-machine-learning-tutorial/" rel="category tag">Arduino Machine Learning tutorial</a></p><p class="post-tags">Tags: <a href="https://eloquentarduino.github.io/tag/microml/" rel="tag">microml</a>, <a href="https://eloquentarduino.github.io/tag/ml/" rel="tag">ml</a></p></div><div class="archive-nav post-nav"> <a class="post-nav-older" title="Previous post: “Principal” FFT components as efficient features extrator" href="https://eloquentarduino.github.io/2020/09/principal-fft-components-as-efficient-features-extrator/"> « “Principal” FFT components as efficient features extrator </a><div class="clear"></div></div></div><p class="nocomments">Comments are closed.</p><div class="footer section large-padding bg-dark"><div class="clear"></div></div><div class="credits"><div class="credits-inner"><p class="credits-left">© 2020 <a href="https://eloquentarduino.github.io" title="Eloquent Arduino Blog">Eloquent Arduino Blog</a></p><p class="credits-right"><span>Theme by <a href="https://www.andersnoren.se">Anders Norén</a></span> — <a title="To the top" class="tothetop">Up ↑</a></p><div class="clear"></div></div></div></div><div class="clear"></div></div> <script src="//cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script> <script src="//cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js"></script>  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-154550080-1"></script> <script>if (window.location.href.indexOf("eloquent.blog") < 0) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-154550080-1');
}</script>  <script>(function() {
setTimeout(function() {
  var d = document, s = d.createElement('script');
  s.src = 'https://eloquent-arduino.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);},
10000);
})();</script>  <noscript><style>.lazyload{display:none;}</style></noscript><script data-noptimize="1">window.lazySizesConfig=window.lazySizesConfig||{};window.lazySizesConfig.loadMode=1;</script><script async data-noptimize="1" src="https://eloquentarduino.github.io/wp-content/plugins/autoptimize/classes/external/js/lazysizes.min.js"></script><link rel="stylesheet" id="fontawesome5-css" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" type="text/css" media="all"> <script type="text/javascript">function heateorSssLoadEvent(e) {var t=window.onload;if (typeof window.onload!="function") {window.onload=e}else{window.onload=function() {t();e()}}};	var heateorSssSharingAjaxUrl = 'https://eloquentarduino.github.io/wp-admin/admin-ajax.php', heateorSssCloseIconPath = 'https://eloquentarduino.github.io/wp-content/plugins/sassy-social-share/public/../images/close.png', heateorSssPluginIconPath = 'https://eloquentarduino.github.io/wp-content/plugins/sassy-social-share/public/../images/logo.png', heateorSssHorizontalSharingCountEnable = 0, heateorSssVerticalSharingCountEnable = 0, heateorSssSharingOffset = -10; var heateorSssMobileStickySharingEnabled = 1;var heateorSssCopyLinkMessage = "Link copied.";var heateorSssUrlCountFetched = [], heateorSssSharesText = 'Shares', heateorSssShareText = 'Share';function heateorSssPopup(e) {window.open(e,"popUpWindow","height=400,width=600,left=400,top=100,resizable,scrollbars,toolbar=0,personalbar=0,menubar=no,location=no,directories=no,status")};var heateorSssWhatsappShareAPI = "web";</script> <script type="text/javascript" src="https://eloquentarduino.github.io/wp-includes/js/dist/vendor/wp-polyfill.min.js"></script> <script type="text/javascript">( 'fetch' in window ) || document.write( '<script src="https://eloquentarduino.github.io/wp-includes/js/dist/vendor/wp-polyfill-fetch.min.js?ver=3.0.0">' + 'ipt>' );( document.contains ) || document.write( '<script src="https://eloquentarduino.github.io/wp-includes/js/dist/vendor/wp-polyfill-node-contains.min.js?ver=3.26.0-0">' + 'ipt>' );( window.FormData && window.FormData.prototype.keys ) || document.write( '<script src="https://eloquentarduino.github.io/wp-includes/js/dist/vendor/wp-polyfill-formdata.min.js?ver=3.0.12">' + 'ipt>' );( Element.prototype.matches && Element.prototype.closest ) || document.write( '<script src="https://eloquentarduino.github.io/wp-includes/js/dist/vendor/wp-polyfill-element-closest.min.js?ver=2.0.2">' + 'ipt>' );</script> <script type="text/javascript" src="https://eloquentarduino.github.io/wp-includes/js/dist/i18n.min.js"></script> <script type="text/javascript">var highlight_and_share = {"show_facebook":"1","show_twitter":"1","show_linkedin":"1","show_pinterest":"","show_email":"","show_xing":"","show_copy":"","show_whatsapp":"","twitter_username":"EloquentArduino","twitter_fa_class":"fa fa-twitter","facebook_fa_class":"fa fa-facebook","linkedin_fa_class":"fa fa-linkedin","pinterest_fa_class":"fa fa-pinterest","xing_fa_class":"fa fa-xing","whatsapp_fa_class":"fa fa-whatsapp","copy_fa_class":"fa fa-copy","email_fa_class":"fa fa-envelope","mobile":"","content":".has-content-area","tweet_text":"Tweet","facebook_text":"Share","linkedin_text":"LinkedIn","pinterest_text":"Pinterest","whatsapp_text":"WhatsApp","xing_text":"Xing","copy_text":"Copy","email_text":"E-mail","icons":"1","facebook_app_id":"2530754057166153","email_your_name_value":"","email_from_value":"","nonce":"5008581d8c","ajax_url":"https:\/\/eloquentarduino.github.io\/wp-admin\/admin-ajax.php","email_share":"Share This Post Via Email","email_subject":"Your Subject","email_your_name":"Your Name","email_send_email":"Send to Email Address","email_subject_text":"[Shared Post] %title%","email_from":"Your Email Address","email_send":"Send Email","email_cancel":"Cancel","email_close":"Close","email_loading":"https:\/\/eloquentarduino.github.io\/wp-content\/plugins\/highlight-and-share\/img\/loading.gif","email_subject_error":"You must fill in a subject.","email_email_to":"Send to Email Address is blank.","email_email_from":"Your email address is blank.","email_email_name":"Your name is blank.","email_sending":"Sending...","customizer_preview":""};</script> <script type="text/javascript">( function( domain, translations ) {
	var localeData = translations.locale_data[ domain ] || translations.locale_data.messages;
	localeData[""].domain = domain;
	wp.i18n.setLocaleData( localeData, domain );
} )( "highlight-and-share", { "locale_data": { "messages": { "": {} } } } );</script> <script defer src="https://eloquentarduino.github.io/wp-content/cache/autoptimize/js/autoptimize_405692bdfc4919582a6406afb9858fc1.js"></script></body></html>
